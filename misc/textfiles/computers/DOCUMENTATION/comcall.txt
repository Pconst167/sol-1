                    COMCALL.EXE Ver 3.0
                       (August 1992)

                  COPYRIGHT(C) 1991/1992
Clive Jones, 111 Deer Park Gdns, Mitcham, Surrey ENGLAND CR4 4DX.
                   ALL RIGHTS RESERVED


COMCALL  is  distributed  under  the  SHAREWARE  principles.  The
Author reserves all COPYRIGHTS (C)  to the program and associated
documentation.  In using this program you agree to the terms that
NO LIABILITY OF ANY KIND EITHER THROUGH DIRECT USAGE  OR INDIRECT
USAGE OR INABILITY TO USE THIS PROGRAM OR FAILURE  IN THE PROGRAM
TO OPERATE AS  DESCRIBED WILL  BE  PAYABLE OR DUE  BY THE AUTHOR.
You are granted a limited  licence  to  use  this  program  for a
limited period of 30  days for evaluation purposes  only.  If you
intend  to  use this  program beyond  the  trial  period  you are
requested to register your copy.   Registered copies will receive
postal  support (telephone  support provided  where possible) and
upgrade options as and when available.   Failure to register your
copy  may result  in  further  development  into  this  and other
packages  not being under taken by  the  author  as  a  result of
financial restraints.   Don't be  a  contributory  factor  to the
demise  of  SHAREWARE.    Assist  the  authors   who  have  spent
considerable  time  and  effort  by  registering  your  SHAREWARE
packages. 

                      ---------------------


This  package comprises  of  the  following  files:- 

                     COMCALL.EXE
                     COMDO.EXE
                     COMCALL.DOC
                     COMBOOT.EXE
                     COMBOOTS.EXE 
                     AUTOEX.BAT
                     AT_SET.TXT.
 
They are distributed within a single self extracting archive file
called:- COMV2.EXE

If you did not receive this package in this form then you should
not use the programs.

Once Comcall has been installed and ran at least once on your PC 
then three additional files will be automatically created:-

     CALLRING.DTL - a log file containing ring/action details
     COMCC.DTL    - a comcall configuration file.
     COMVALS.DTL  - holds default values for the comcall session


                      --------------------


If you have a telephone,  a Hayes command set modem and an IBM or
compatible running under DOS or Windows,  then COMCALL  may be of
use.

COMCALL is a package that is designed to monitor  your phone line
in  your  absence.   It will either call  you at  ANY other phone
location that  may be  directly  dialled   to   advise you when a
pre-defined trigger   is  met or execute a command to  start some
alternative   action.   Alternatively Comcall will simply monitor
and log any incoming  calls  such  as  when  you  are  using   an
answerphone with  no  call  time  logger.   Comcall is constantly
under further development.  For future versions it is intended to
add even greater flexibility in  Comcalls usage so as  to include
such possibilities as the remote control of physical actions such
as video recorder  control,  light operations,  curtains etc with
the  control being performed via  a  single  telephone  line that
could be shared with other devices eg voice/answerphone/fax/data.
 
Comcall will work with many existing  telecommunications hardware
devices such as existing phones, extensions, answerphones etc.

No special hardware  is  required  at  the recipient  end  of the
triggered  call  if a  telephone advice action is  selected.  Any
phone that  may  be  DIRECTLY  dialled is sufficient.

This version  of  Comcall  is  distributed  under  the  Shareware
principles.   Future versions may only  be  obtainable  by  users
already  registered   under  the Shareware release of the current
version.      

The trigger for COMCALL is a range of counts of incoming rings to
your  telephone.   You define this  upon starting COMCALL  and is
totally variable.  Such as one (and only one) ring being received
(eg like a RINGBACK set up)  or maybe between 2 and 4 rings (your
answer phone would have received a message),  or maybe  all rings
eg 1 - 999 (999 being the COMCALL limit).

Only consecutive rings from one call are counted.  If the trigger
condition is  not met then  the  ring  count  will  be  reset and
Comcall will wait for subsequent calls.  

All incoming rings are logged to  a file  called CALLRING.DTL for
later inspection  if  required.   Useful  if you've been  out and
would like to see how many calls you missed.

Comcall  may  be   individually  configured  to  suit   your  own
particular needs.

Comcall  now incorporates a  dual trigger condition,  so that two
ranges of trigger options may be defined in order  to perform two
separate operations  according  to  which  trigger  condition was
encountered.

Comcall Version 3  is distributed as a fully functioning version.
In trust of its capabilities and of its users I have  decided not
to  cripple  or  disable  its  functionality  in  any  way.


                       EXAMPLE USAGES OF COMCALL:

1.  

You have an  answerphone but it  does not have a  time/date stamp
option.   You go away for the weekend only to return to  a number
of messages.  When were these messages taken?  Providing  you had
invoked Comcall then  you will  be  able to see exactly  when the
messages were left (day and time).   You will even be able to see
how many calls resulted in messages not being left. 

2.

A family member may be ill in hospital or your wife may have been
taken into maternity as her babies due date  nears.   You have an
answer phone and you have  to  go  out on  some  urgent business.
You  are fearful that  you may receive  that  all  important call
whilst you are out.   The answer phone will take the  message but
you won't know of  this until you  next return home  or until you
phone  up  and interrogate your  answer phone  next (assuming you
have a remote access answer  phone).   Provided you either have a
radio pager or know the telephone  number of the person  whom you
are visiting worry no further.   Simply invoke COMCALL to monitor
your line,  giving it  the number  of  the  person  whom  you are
visiting (or the radio  pager  number).   Go  on  out  about your
business  and   if  a  message  comes   in,   then  you  will  be
automatically advised.

3.

You are in  the office  late  on  a  Friday  evening.   You still
haven't met that all important deadline for your  project and you
really should come  in over the weekend to  finish  of that draft
overview.   But your office is over 30  miles away.   You are not
permitted to take disks out of the office and no  inward external
network access  exist into  your PC system  for security reasons.
Your office  PC  does  however have  a  modem  for  outgoing data
transfer and you have a PC,  Modem and Communications Software at
home.   Simply invoke your copy  of COMCALL to trigger  after say
just one (and only one) ring of your office telephone.  When this
trigger is met you want it to  start your comms  package that has
been set to  autodial  your home phone number.   You can  then go
home in the knowledge that you do not  have to drive all  the way
in tomorrow  and can work  from  home.   All that is required the
next day is for you to call your office phone, hang up after just
one ring, set your PC, Modem and Comms package to autoanswer data
mode and then wait for the return call from your office  PC.  You
should be confident that no one else will ring your  office phone
just once  and then  hang  up.   Even if then did it would  be of
little consequence as  you would get an  a simple  call from your
works PC which you could then just hang up on.  Provided you have
set up the triggering system correctly,  your works PC would then
resume waiting for another single ring. (See USING below). 

My set up :- I use Comcall for a threefold purpose.  Firstly I am
on occasions telephoned in the middle of the  night with messages
that have  to be dealt with  promptly.   My answerphone will take
these messages, but, being a sound sleeper, I am seldom awoken by
the few rings prior to the answerphone starting.   I  set Comcall
to a ring range count of 1 - 10 (eg any calls) and an action of E
REM.   Additonally I set the delay time to 360  and delay tone on
so as  to  raise an  alarm that  continues  beyond  teh telephone
ringing  period.   Any  calls  that  come  in  during  the  night
therefore raise a PC alarm tone.   Secondly, as my office is over
15  miles  away,  I  set comcall to  call  me with advise  of any
pending  messages that may be  left on my  answerphone throughout
the day.  I utilise my answerphones remote interogation option to
then respond to any important matters.  Finally, I use Comcall to
allow me to call into my home PC from my office.  I only have the
one telephone line  sharing both  the answerphone and  modem.  To
use my home PC I simply set a trigger range of  1-2  rings and an
action of X with an error level of  2.   This error level is then
picked up from within my  modified autoexec.bat file  in order to
start my  comms package in  host  mode  and await my  return data
call.   I utilise the re-boot option  for this  to  ensure that I
re-call within  5  minutes,  otherwise the PC reboots and reloads
Comcall via the autoexec.bat file.


                     SET UP/ INSTALLATION.


COMCALLs file  should  be  ideally  placed   in  the  same single
directory.

Comcall   consists    of a number  of files,  these are described
below:-
COMCALL.EXE  the executable  file,  COMDO.COM  which  is  used to
execute the desired commands/files and COMCALL.DOC - this manual.
Once  Comcall has  been   run  once  further  new  files  will be
automatically  created  called   CALLRING.DTL  -  This   file  is
used to    hold  details   of COMCALLs actions  (rings  received,
actions taken   etc.  It is  an  append  mode file so  you should
therefore periodically  monitor  and  delete  it  as  necessary).
COMCC.DTL    - This file holds the configuration details that you
may select for your comcall sessions.    COMVALS.DTL -  this file
is used to hold initialisation  values each time  that comcall is
invoked.  
UNDER NO CIRCUMSTANCES SHOULD YOU MODIFY THESE .DTL FILES USING A
TEXT  EDITOR.    Comcall  relies  upon  these   for  its  correct
functioning.   If  they  become corrupted with invalid  data then
Comcall may perform in an un-predictable fashion.

COMBOOT.EXE is a Terminate  stay resident program (TSR)  that can
be  used  to  invoke a  cold re-boot.   COMBOOTS.EXE will stop an
impending reboot requested started using COMBOOT.

In addition to these files, a file called AT_SET.TXT is provided.
This provides a basic list of Hayes Commands for those of you who
might  have  mis-laid  their modem manuals.   This should  not be
taken as  a definative  list  for your  particular  modem  and is
provided  purely  for the purpse  of guidance.   Finally the file
called  AUTOEX.BAT  is provided as  a basis upon  which you could
build your  own file  that  utilised  Comcalls  X conditions (see
usage).

Prior to using COMCALL you must have a MODEM  (Hayes Command Set)
connected to the specified COM  port.   The modem must be powered
on prior to the invoking of COMCALL. 

To install comcall for the first time   simply  type  COMCALL and
read the  notice.   Thereafter  type  COMCALL  C  and  follow the
guidance  given.    A  new  configuration  file  will  be created
automatically.   You may modify  this  configuration   now  or at
any  other later time    by  re-using  the   Comcall  C  command.
After   this  you  can  use  Comcall as required using any of the
available  commands.   The options  that  you  may  configure are
described below:-


COMCALL C     COMMAND - CONFIGURATION OPTIONS


To configure the Comcall options -  enter <comcall c>  at the dos
prompt.

You will then be presented with a number  of options  that may be
modified.  To select one of the options to modify, simply use the
up  and down  arrow keys until  that option is  selected and then
press the <ENTER>  key  to  enter into  the modify  mode.  In the
modify option you will see the original value and be prompted for
a new value.   You may exit from this by pressing the  escape key
or by pressing the enter key  without having entered  a value for
the new option.   Entry of a new  values do not come  into effect
until after the save option has been selected.  Use of the escape
key will therefore result in the previous values being maintained
for the various options.


The options that may be modified are:-


1.  Modem Initialisation String. (Consult your modem manual).  

It is not recommended that you change this unless you are sure of
what  you are doing.   The  initial value that  is  supplied with
comcall is ATE1V1H0S0=0  this will ensure that your modem  is set
into the required verbrose message mode and to never auto answer.
These are standard Hayes command set commands.  In some cases you
may wish to add further Hayes modem control commands in  order to
suit you own particular needs.  This is where you would add these
as desired.


2.  Delay Time

This   is   the  delay time   (in   seconds)   between  a trigger
condition    being   met   and   the   time   that   the   action
specified   executes.   For  telecommunications   actions  it  is
recommended that this figure be set high enough to allow  for any
time that another person may be using your phone locally in order
to complete  an  incomming call.   The minimum delay period  is 5
seconds,  max = 999999.  Any values entered outside of this range
will have a default of 120  seconds applied.  You   will   notice
that  delays    are  incorporated    into  a   number   of    the
functions of COMCALL.   This delay is defined here. These  delays
are present to ensure  that sufficient    delay  periods   exists
when modem     functions   are performed.   For example the delay
count prior    to   initiating the  execution or advisory message
is   in  place so  as   to    ensure that any incoming   messages
should have completed   (eg  an  answerphone)  prior  to  COMCALL
making  the outgoing  advisory  call  (after  all   you  would be
sharing the same telephone line).


3.    Delay  tone.    

Prior   to   Comcall  starting   an   action following  a trigger
condition,    the  delay  period  (as   of 2 above)  may  or  may
not  have    a warning tone    sound.    This is useful  if   you
wish   to  advise  local  personnel  of  such an impending action
so that it may be aborted if required. 


4.  Colour/Black White.

If you have a black and white monitor then  you  should  set this
option to 'B'.  Otherwise set it to 'C' for colour.


5.  Tone/Pulse Dialling.

If your local exchanges and modem can issue MF tone dialling then
set this option to 'T' (tone).  Otherwise set it to 'P' (Pulse).
If you are not sure as to which type of dialling is  local to you
then it  is  recommended that  the 'P'  option  is  used  as this
usually works on both.


6.  Com Port 

You should enter the number (1-4) of the com port that your modem
is connect to.


7.  Busy Tone Retries.

COMCALL  will   re-issue a call   if   the BUSY tone is  detected
upon executing an advisory  call.   Define the number of re-tries
here  (max  10).   Note that some modems come with  a 'Blacklist'
test for where a number may be dialled unsuccessfully on multiple
occurences.   If you have such a modem, then the number of actual
retries performed will  be  the lower of  the value set  for busy
re-tries and the blacklist limit.


8.  Reverse Dialling Command.

To enable  some  form of indication  at the recipient  end of the
named telephone number  this  program issues  a  reverse ringback
command signal to your modem when making an advisory call.  
If you are unsure about reverse dialling,  do not worry too much,
it basically means that  the person  answering the  advisory call
will hear DATA TONES.   Thus implying that an advisory call is in
progress.    Without  the  reverse  dialling  mode,   the  person
answering the call  would hear  nothing  and  may  assume  that a
telecommunications  error  had  occurred.   Not  all  modems  may
support the ringback option,  but the ones that do usually have a
command sequence of R to invoke  this option  (consult your modem
manual  for  further  reference.   In  some  cases  this  reverse
ringback string  is  an  '/R'  eg  with  a  forward  slash).  The
reverse dialling command option should  therefore be  set to your
particular modems command (consult your modem manual).  The Hayes
command set defines the Ringback  command as  a single  R, so you
will  probably  have to change  the Comcalls default  of /R.  The
default  will  probably  be  changed  in  future  releases  if so
requested by popular demand - but as my modem expects a /R I have
left the default to match this.

                     
COMCALL B    COMMAND - BROWSE LOG FILE. 


This is a command that may be issued from the dos prompt in order
to browse the comcall  log file CALLRING.DTL.   Callring.dtl is a
text file and may also be  browsed using other text  editors.  In
the browse log mode  you can use the up  and down  arrow  keys to
move about the display.  To exit the browse mode simply press the
<ESC> key.


COMCALL M    COMMAND - BROWSE MANUAL FILE.


This  command is  issued  at  the dos prompt  in  order to browse
through  this  file  (COMCALL.DOC).   It  operates  in  a similar
fashion to that of the COMCALL  B option with the  exception that
the page up and down keys will scroll the text in page lengths.


COMBOOT  x  COMMAND - REBOOT


As some applications of Comcall can result  in  memory contention
(eg  where Comcall  is  used  to  invoke  other  packages)  it is
sometimes desirable to have  an automated re-boot  option so that
Comcall  may  be  re-initialised  via  your   autoexec.bat  file.
Comcall  now provides  such  an  option  by use of the  COMBOOT x
option that may be  executed from the dos prompt  or  from within
bat files.   x  is a value  between 0  and 59 (minutes).  Issuing
such a command will result in a cold re-boot of your system after
the time period of x minutes has elapsed.  eg 
                       comboot 2
would result in a system reboot in  (Approx)  2 minutes from now.
In the mean time any other  command or action could  be performed
without affecting this  request (unless  you  execute  a comboots
request that is (see below)).   Similarily comboot 0 would result
in an immediate re-boot occuring.

The  reboot  option  results in  a Terminate Stay  Resident (TSR)
being installed.  Under some circumstances other applications may
contend  with  this  TSR.   Always check your  set ups thoroughly
before relying upon  them.   For example,  I have found that if I
invoke windows (Win)  following the setting of a  reboot request,
then at the reboot time the only action that is performed is that
windowns is stopped (returns to the dos prompt).   The way around
this is to create a batch file (.bat) that will call another boot
request eg 
                .
                .
                cd \comcall
                comboot 1    { reboot after 1 min within windows}
                cd \windows
                win          { start windows }
                comboot 0    { reboot immediate request }
           
     
WARNING: COMBOOT will invoke a cold reboot no matter what!.  This
is usually described as  a  bad  practice  as  the  state  of the
machine at the time of the reboot request is unknown (resembles a
power failure).   Any files that may be open, or any I/O that may
be occuring at the  time of the reboot  will thus be  affected by
the reboot.   If you treat the reboot command as a similar effect
to  that  of  powering  off/on your PC  then you won't  go to far
wrong.   If you decide  to use  the reboot option then  treat the
command with respect.


COMBOOTS    COMMAND - STOP REBOOT REQUEST. 


If the Reboot (COMBOOT)  is invoked either in a bat  file or from
the dos prompt and you wish  to  abort this auto reboot  then use
the Comboots command,  again from the dos prompt or  within a bat
file.   This is useful where Comcall may be driven by a .bat file
that invokes a Comms package awaiting  for  your  return  call in
data mode.   If a reboot request were  contained within  this bat
file in order to reset your system back to Comcall if you did not
recall within a time period  of x  minutes,  then if you did call
back in data  mode then you would execute  this  Comboots command
upon establishing your data link to stop such a reboot.


COMCALL      COMMAND - EXECUTE COMCALL


By  entering  <comcall>  alone  at  the dos prompt,  you  will be
automatically taken into the main comcall process.

Initially you will  see a  couple  of  time  delayed introductory
screens.   Thereafter,  you will  be  presented with  the session
configuration screen.   Each time that you modify and save any of
these then they will be applied to  all future  usages of Comcall
until  such  times that they may be  modified  again.  This entry
configuration screen has a auto-entry delay count  of 10 seconds.
Pressing the <esc> key will by-pass this delay.  If no other keys
are pressed within this time  then the main comcall  process will
be entered.   This delayed auto entry enables comcall to  be used
in batch file processing (eg .BAT files)  where it  is known that
the default session options have  already been set  to a suitable
value.   For  each  Comcall  session,  two  trigger  options  are
available.  You may therefore define separate actions to be taken
for each of two separate  trigger conditions  (ring ranges).  The
options that may be modified are :-


                       COMCALL ENTRY OPTIONS


LOWER AND UPPER RING COUNTS

The ring counts (lower/upper) should be set to the range of FULL
RINGS that you wish COMCALL to trigger an action upon receipt of.
These values may be identical so as to stipulate an  exact number
of RINGS to  trigger.   The minimum  number of rings that  may be
specified  is  1.   The  maximum upper level is  999  RINGS.  For
ranges of RING COUNTS the values are considered to be inclusive.
There  should  be  no  over lap  between the ranges  for OPTION 1
trigger action and OPTION 2.   FULL RINGS varies from  country to
country.   For example  in  the  UK  with   the  Brrr-brrrr  ring
Comcall  will  take   all  or   any part of this   to  be  a full
ring.    It   is   worth noting  that  in some countries that the
ring heard by the caller and the ring heard by  the called person
may not be   in phase.    Comcall responds  to  the  actual rings
received  locally.    Comcalls ring   counter will only increment
when your modem detects such a ring.   This can lead to cases  of
where say a caller   hears  only   one   ring cycle,  whereas  at
the receiving end   a   two   ring   cycle   could have occurred.
For critical   operations   it  is therefore recommended that you
select   a ring  trigger  range  over  a  number  of ring cycles.
When you wish to trigger this remotely,  then select   a mid ring
count between these two values when making the trigger call. 


EXECUTE/TELEPHONE/EXIT E/T/X OPTIONS

These  parameter should be set according to   what   the required
trigger action should be eg 'T'  a telephone advisory call should
be made  to the  number   defined in the command/telephone option
(see later).    The 'E'  option enables the command as defined in
the  command/telephone option  to  be  performed  if  the trigger
condition is satisfied.  Any dos command or  program filename may
be called  (even a call  to  a .BAT file if  required),  together
with any parameters required by  that called program (there  is a
upper  limit of 4  parameters that may be  passed).  The X option
is used  where it  is desired to use comcall in  .BAT  files.  In
some cases using the E option will prevent the  successful reload
of comcall (eg if a trigger condition is met and  another program
is executed that takes all of  the memory  available for  its own
use).   In using the X option,  you  can define  an errorlevel at
which  comcall should  halt  with  following the  receipt  of the
desired trigger condition.  This errorlevel should be  defined in
the  command/telephone option (see later).   A bat file  can then
pick up  on  this  errorlevel  in  order to  perform  the desired
operation using the bat file 'errorlevel' operand.  


COMMAND/TELEPHONE

This is the  action command itself.   If a T options  is selected
for the action option (see previous) then this should contain the
target phone number.   If a E option is selected for  the command
action then  this  should  be  a dos command or  program filename
(filenames should be full filenames etc comcall.exe).  Up to four
parameters may be included with the command eg echo hello there.
If an X command action is selected then this should  be a numeric
value (greater than one, less than 100) to which the desired exit
errorlevel is  to  be  set.   For  more  information on  BAT file
processing and errorlevel values - consult your operating systems
manual.

For T options (telephone) you may be able to define delay periods
by including an additional character in this  string (consult yur
modem manual).   For example, when an advisory call is to be made
out  through  an  automatic  switchboard  eg  requiring  a prefix
digit(s)  to be dialled,  followed by a short delay, then you can
use this delay  character to cater  for this.   Lets say that the
delay charater  is  a comma (,),  and your number for  gaining an
external line is 9.  If you wish to call the number 123-4567 then
your telephone command line  value would be  :=  9,12345678.  (Do
not include any dashes in telephone number command  actions.)  On
receiving  a trigger condition,  Comcall will  then instruct your
modem to dial the digit 9, followed by a short delay, followed by
the number 1234567.   This delay character can vary from modem to
modem, so consult your modems manual for further advise.  In some
cases you may wish  to  concatenate a number  of  delays, usually
this can be achieved by using two or more of the delay characters
consecutively eg 9,,,1234567.

 
                         USING COMCALL   

     
For COMCALL to work your PC and Modem must be left on.  Any power
loss  to  your  system  will  result  in the loss of  the COMCALL
monitoring.   To ensure against power glitches you could copy the
COMCALL command to  the last  line  of your autoexec.bat  file so
that should the power fail and then be restored then the PC would
reboot and re-execute the COMCALL command automatically.  

COMCALL  liaises  with  your  modem.   You  should  use  a  HAYES
compatible MODEM and command set.   COMCALL requires that verbose
commands are returned from your modem (not digit values) and that
the modem is set to never answer.  These can usually be set using
the AT(tention)  commands as defined for your  modem once COMCALL
has  been  invoked.   The  most commonly used  AT commands within
COMCALL is to set your modem to  never answer  (S0=0) and verbose
listing (word messages).   This is automatically  sent within the
initialisation process of  COMCALL  when  invoked  (providing you
have not modified it using the Comcall C option).  Once  you have
invoked   COMCALL you will   be  in a terminal session  with your
modem.   Type AT (attention) followed by the enter key   directly
at   the  terminal  screen.   You  should  then  see  the  modems
response of  OK.    If this  does  not   occur  then  you  should
check your modem and COM port.   

Comcall now incorporates  dual  trigger definition.   That is you
can define two separate actions to  be taken upon the  receipt of
two different ring ranges.   If you do not want any actions to be
taken,  eg  using Comcall purely  as  a logging  device,  then we
suggest that  you use trigger actions of  998/998   E(xecute) REM
for option  1  and 999/999  E(xecute)  REM for option 2.  Comcall
will thereafter only  log any details of  incomming calls  to the
log file  (CALLRING.DTL)  which may be  browsed  later  using the
Comcall B option  from  the dos prompt.   Note that in  this case
then  if  a ring  count in  the range 998-999  rings  is detected
(extremely unlikely) then the only action performed would be that
Comcall would log a remark (REM) statement in the log file.

Once you enter Comcall then try   typing in a Capitalised RING at
the terminal screen.   You should see the  response  of the  time
of the ring   and the ring   count.  If further rings are entered
in quick succession  you   should  see the ring  count increment.
(Beware not   to enter the   same number of rings as  defined for
your   trigger  otherwise  the  trigger will occur at  this  test
stage - unless you wish to test your set up that is.)   If  there
are delays   of   over 10 seconds between the  last and the  next
ring then   the  ring  count will be seen  to revert back  to one
(assumes a new call).

If you utilise the  program file execution  option,  then COMCALL
may or may not be resumed upon completion of  this depending upon
the  utilities called  (memory space etc).    Test  your  set ups
prior to depending upon  them.   If COMCALL does not  resume then
try  setting up  the BAT file  using the X command  option  and a
suitable errorlevel (see below).  

Lets say that you have a comms package that  you wish  to  invoke
upon a selected ring count  condition being met.  We'll call your
comms package  compac  for  this  example.   Your  compac program
allows   for the creation of script   files.   You have created a
script  file that will result in a comms link being automatically
set   up   when the script  is  invoked.   The  compac package is
assumed to  allow you to  invoke  compac and  the script directly
from  the  dos  command  line  eg    if  the   script  is  called
ringoff.scr -  compac allows you to invoke it and the ringoff.scr
by using the command

                         compac ringoff.scr

You  want this comms package to  be  run every time  that comcall
detects  only one  ring (one and only  one rings).   We will also
assume  that  your  modem  is  connected  to  your  COM  port  2.
Additionally,  lets also assume that your comms package compac is
in a directory called c:\comms  and that your COMCALL  package is
in a directory called c:\comcall.  Lets say that you want to make
Comcall exit with an errorlevel of 2  when the trigger is met and
invoke your comms package (await your return call  in data mode).
Finally lets also assume  that if you do  not call  back within 5
minutes in  such  a data  mode  then you wish Comcall  to restart
again.

Enter  Comcall and selected  the required  options at  the action
screen.   Your Upper and lower ring counts should be set to 1 and
1  (eg one and only  one ring).   Additionally your  E/T/X option
should be set to X and the Command/Telephone Option  set to  2 (2
is the minimum 99  is the maximum errorlevel that may be  set for
this X option.   Any other value outside of this  2-99 range will
result in a default of  2  being applied).   As you only want one
ring  range to  be  the trigger condition then  set the  Option 2
values  to  say 999/999  rings,  E(xecute) REM command.  Now save
these using the Save/Exit option.   Once at the terminal screen -
exit Comcall using the ALT X option.   Now each time that Comcall
starts  in  future  then  these  options  will  be  automatically
installed.  Thus you can now include the command Comcall in a bat
file (such as your autoexec.bat)  at will.   Once the bat file is
run and  the comcall command issued,   then   following   a short
delay  Comcall   will  be automatically initialised and entered.

You bat file  (consult your dos manual  for help regarding  batch
files) - may contain something like the following :-


          cd c:\comcall              - your comcall directory
          comcall                    - start comcall
          if errorlevel 2 goto trig  - if comcall exits with
                                     - errorlevel of 2 then goto
                                     - trig 
          goto reboot                - otherwise goto reboot
          :trig 
          comboot 5                  - reboot system in 5 minutes
          cd c:\comms                - your comms directory
          compac ringoff.scr         - start your comms package
          :reboot 
          comboot 0                  - reboot imdediately 


A similar bat file  to  that  of  the example  above  is included
within the COMCALL package.

(Note the description on the right is for descriptive purposes -
do NOT include this in your bat file.)

Saving  such   a  command sequence   to  your  Autoexec.bat  file
followed  by  a  reboot  (CNTL-ALT-DEL)   would  result  in   the
continuous   sequence of  comcall being   invoked and waiting for
one and only one rings.   Then once  this trigger was met Comcall
would stop  with  an  errorlevel of 2  which would start a reboot
request after 5  minutes  followed by the   Compac  comms package
being started using the ringoff.scr   script   file  in  order to
wait  for your return data  call.    Normal exiting  from  compac
will result in your   system rebooting as a result   of  the cold
reboot Comboot 0  command.    Once the  system  starts  up  again
the  whole process   could be   repeated.   If you call into your
comms package from a remote site you should immediately execute a
dos shell  command  of  COMBOOT  in  order  to  stop  the re-boot
countdown.   If you didn't log into your computer then, after the
5  minutes delay stated in the COMBOOT 5 option your system would
reboot and start the .bat file  all over  again.  Thus preventing
your system being possibly left in data mode for the  rest of the
day.

The  benefit of  such  a set up  is that should  your mains power
supply fail   for  a brief period,   then  the  set  up  would be
re-entered once again after the power had  been  re-established.
It also ensures that your system should not hang  as  a result of
memory contention preventing Comcall from correctly  working upon
re-entry.

(Note that Compac is a name  chosen purely in  an arbitary manner
in order to provide a demonstration.)

                            -----------

Occasionally you should  browse  the  CALLRING.DTL  file  that is
created automatically by COMCALL.   This file contains all of the
rings and the times that  they  were  logged  whilst  COMCALL was
active.   This file will continue to  grow until  such times that
you delete it.   Once deleted a new copy will be started the next
time you re-enter COMCALL.

COMCALL has primarily be  developed and tested  in  the UK.  Some
increase  in  the RINGING tone  received  whilst  COMCALL and the
Modem were active have been reported.  This should not be a cause
for concern.   In theory the package should work  as equally well
on  a multitude of  telecommunications networks.   We have (as of
the current date)  not received any reports of COMCALL failing to
work on any given network.

Some  difficulty  in  the anticipated functioning of  COMCALL may
occur if  another incoming  ring is made  at the  same instant in
time when COMCALL issues an advisory call command.   However, the
instances when this occurs should be extremely few in view of the
small timeslot window when such conditions may occur.

When  COMCALL initiates an  advisory call,  the response messages
from that call are monitored.  If a BUSY message is received then
the call will be  retried after a short delay (providing the busy
re-tries or modems Blacklist limit has not been reached).   

In all of the  EXECUTE,  X and ADVISORY CALL (T)  modes,  a delay
from   the time when   the trigger   ring  receipt  was  received
and  the trigger function operates exists.  This is via a counter
level being decremented and displayed upon  the  terminal screen.
If  you wish  to  cancel  the trigger function   and resume  RING
monitoring,  then the ENTER key may be pressed  during this delay
period (eg you may have  answered  your  phone locally and you do
not wish  for the advisory call to progress to completion). 

To  quit  out of  COMCALL use the combined  keystrokes  of ALT X.
(Some  limited  help  may  be  obtained  by  using  the  combined
keystrokes of ALT H).


                           REGISTRATION


ENQUIRIES MAY BE MADE DIRECT TO  THE AUTHOR AT THE  ADDRESS BELOW
OR VIA COMPUSERVE TO ID     100014,3141.

If you  found this package  to be of  some use and  would like to
continue to use it beyond the evaluation  period of 30  days then
remit your  payment and details to  the address  below.

                       Clive Jones
                       111 Deer Park Gardens
                       Mitcham
                       Surrey
                       CR4 4DX  

Registration   entitles   you   to   support   of   the   package
(postal/electronic  mail  plus  telephone where possible).   As a
registered user you will also be advised of upgrades  as and when
they become available.

The suggested minimum registrational contribution is 10 UK Pounds
Sterling or 20.00 US Dollars. This entitles you to a continuation
in a single  licence beyond   the   30   day   trial  period  and
package  support   together     with     automatic   upgrade   to
the   next  available   version  as   and   when   this   becomes
available   (don't   forget       to      state     your     disk
size/format).      Currently  registered  users  (prior   to July
1992)  need only  send a stamped self addressed envelope and disk
for  return  of  a   personal  copy  of   the    latest  release.
Alternatively  you may register  on    a one-off basis    for the
current  version  for only 5  UK  pounds  (8 US Dollars). 
 
COMCALL.EXE  source  code and rights are available for sale.   
Contact the author for further details.

ENHANCEMENTS.      Upon   proof  of   sufficient  interest in the
program (eg registrations/enquiries)  then the  author pledges to
provide  further    releases    of  Comcall.   Your  registration
contributions will  ensure  that such improvements  see the light
of   day.    Such  later   releases   may only    be available to
currently registered users.


                             HISTORY


Dec    1991. Version 1 Released.
April  1992. Version 2 Released.    
       Modem Initialisation Modification.
       Pulse Dialing bug fix - thanks to Kevin Black
       Log file format modification - thanks to Dave Woolcock
       User definable delays/modem initialisation added.
       Key entry screen modified to delayed entry for auto recall
       Thanks to Dave Hickman (CA, USA).
       General minor changes.
       Configuration options added.
       Browse log option added.
       Delay tone toggle added.
       Delay time from real time and not machine specific.
August 1992.  Version 3.
       Moved from command line to prompted initialisation.
       Dual Trigger Conditions Added.
       Time display.
       Colour Options
       Warning Tone on/off Options
       Ringback string definition.
       Auto Delay Entry modification.
       Batch file option added.
       Browse manual option added.
       Busy tone retries level option added.
       Reboot option (TSR)


                       ----------------------
                          CURRENT VERSION
                       ----------------------

Comcall is continuously under further development.  We appreciate
comments and views with regard to possibly improving the package.
If you do  find  any errors  or have any constructive  ideas then
drop us a line.   The author  has put in  considerable effort and
time  in  creating  Comcall.    Its  nice  to  know  whether  his
endeavours are being appreciated.


                 ------------------------------------   
                  U N D E R    D E V E L O P M E N T
                 ------------------------------------ 

Unless you register for the current version of  COMCALL,  you may
miss out on  future developments.   Currently Comcall is entering
an  exciting phase.   Soon we hope  to be bringing  you a package
that will be unique in its field.   A package that will offer new
meaning to  the term  'remote control'.   Operating over a single
telephone line  that may be shared  with normal voice  and answer
phone set ups,  you will be able to remotely control  your video,
stereo,  tv,  curtains,  lights,  garage doors etc.   If  you are
registered with Comcall,  then you will  be automatically advised
of when  this  becomes available.   All  in  addition to Comcalls
existing functionality.   The  next  release of  Comcall,  may be
released via Commercial  methods or  may still  be  via Shareware
distribution.   However,  for  all  users  registered  under this
current  version,  the next  release will  be offered  as per the
current terms.       

                     -----------------------


Do you use shareware software on a regular basis.   If you do and
you would like  to  be paid to  receive and evaluate  some of the
latest and golden oldies programs then contact the  author at the
above  address.   This  is  a  genuine  offer  where considerable
payments can be received for less than  ten minutes of  your time
each month. Could just be the best enquiry you make in your life.


                     ----------------------------


                      EEEEEE    NN    N    DDDDD
                      E         N N   N    D    D
                      EEEE      N  N  N    D    D
                      E         N   N N    D    D
                      EEEEEE    N    NN    DDDDD

                     ----------------------------
